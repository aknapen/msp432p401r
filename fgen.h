/*
 * fgen.h
 *
 *  Created on: May 11, 2020
 *      Author: sdanthinne
 */

#ifndef FGEN_H_
#define FGEN_H_
#define MIN_OUT_RATE 7 //the minimum amount of time it takes to write out to the DAC. (in us)
#define SAMPLE_TIME (MIN_OUT_RATE + TIME_MARGIN)
#define TIME_MARGIN 63 //TODO: some margin of time to allow for errors. (in us) (currently experimentally set)
#define DCO_SPEED 24

#define SAW_TUNE (20/4)
#define SIN_TUNE (1325/700)

#define INTERRUPT_FREQUENCY 100 //undefined currently
#define MAX_SQUARE_COUNT 3412 //undefined currently

//types of waves that the wave gen supports.
#define SQUARE_WAVE 1
#define SAWTOOTH_WAVE 2
#define SINE_WAVE 3
#define TRIANGLE_WAVE 0

void main_fg(void);

static const uint16_t square_wave[2] =
{
     0,930
};

uint8_t wave_type;//the type of the wave - refer to macros
uint8_t duty_cycle;//duty cycle of square wave (1-9 -> 10%->90%)
uint16_t frequency;//the frequency of the output wave in Hz
uint8_t is_ready;//flag denoting when the mcu is ready to write a value to the DAC

static const uint16_t sine_wave_3v[512] =
{
 465,471,476,482,488,494,499,505,511,516,
 522,528,533,539,544,550,556,561,567,572,
 578,584,589,595,600,605,611,616,622,627,
 632,638,643,648,653,659,664,669,674,679,
 684,689,694,699,704,709,714,719,723,728,
 733,737,742,747,751,756,760,764,769,773,
 777,781,786,790,794,798,802,806,810,813,
 817,821,824,828,832,835,838,842,845,848,
 852,855,858,861,864,867,870,872,875,878,
 880,883,885,888,890,892,895,897,899,901,
 903,905,907,908,910,912,913,915,916,917,
 919,920,921,922,923,924,925,926,927,927,
 928,928,929,929,929,930,930,930,930,930,
 930,930,929,929,929,928,928,927,927,926,
 925,924,923,922,921,920,919,917,916,915,
 913,912,910,908,907,905,903,901,899,897,
 895,892,890,888,885,883,880,878,875,872,
 870,867,864,861,858,855,852,848,845,842,
 838,835,832,828,824,821,817,813,810,806,
 802,798,794,790,786,781,777,773,769,764,
 760,756,751,747,742,737,733,728,723,719,
 714,709,704,699,694,689,684,679,674,669,
 664,659,653,648,643,638,632,627,622,616,
 611,605,600,595,589,584,578,572,567,561,
 556,550,544,539,533,528,522,516,511,505,
 499,494,488,482,476,471,465,459,454,448,
 442,436,431,425,419,414,408,402,397,391,
 386,380,374,369,363,358,352,346,341,335,
 330,325,319,314,308,303,298,292,287,282,
 277,271,266,261,256,251,246,241,236,231,
 226,221,216,211,207,202,197,193,188,183,
 179,174,170,166,161,157,153,149,144,140,
 136,132,128,124,120,117,113,109,106,102,
 98,95,92,88,85,82,78,75,72,69,
 66,63,60,58,55,52,50,47,45,42,
 40,38,35,33,31,29,27,25,23,22,
 20,18,17,15,14,13,11,10,9,8,
 7,6,5,4,3,3,2,2,1,1,
 1,0,0,0,0,0,0,0,1,1,
 1,2,2,3,3,4,5,6,7,8,
 9,10,11,13,14,15,17,18,20,22,
 23,25,27,29,31,33,35,38,40,42,
 45,47,50,52,55,58,60,63,66,69,
 72,75,78,82,85,88,92,95,98,102,
 106,109,113,117,120,124,128,132,136,140,
 144,149,153,157,161,166,170,174,179,183,
 188,193,197,202,207,211,216,221,226,231,
 236,241,246,251,256,261,266,271,277,282,
 287,292,298,303,308,314,319,325,330,335,
 341,346,352,358,363,369,374,380,386,391,
 397,402,408,414,419,425,431,436,442,448,
 454,459,465
};

#endif /* FGEN_H_ */
